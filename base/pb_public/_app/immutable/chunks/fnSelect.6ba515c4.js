const G=(n,a)=>{const d=(i=!1)=>{i?n.classList.add("modal-open"):n.classList.remove("modal-open")},o=i=>{i.target instanceof HTMLElement&&n===i.target&&n.dispatchEvent(new CustomEvent("close"))},f=i=>{i.key==="Escape"&&n.dispatchEvent(new CustomEvent("close"))};return d(a),n.addEventListener("mousedown",o,!0),window.addEventListener("keydown",f,!0),{update(i){d(i)},destroy(){n.removeEventListener("mousedown",o,!0),window.removeEventListener("keydown",f,!0)}}},z=(n,a)=>{a=a.replace(/\[(\w+)\]/g,".$1"),a=a.replace(/^\./,"");const d=a.split(".");let o=n;for(;d.length;){const f=d.shift()||"";if(o){if(!(f in o))return;o=o[f]}}return o};function J(n,a){let d;const o=n.getAttribute("keyvalue")||"id",f=n.getAttribute("keylabel")||"name",i=n.hasAttribute("multiple");let y=[],l=[],g=!1,h=-1,x=!1;const c=n.querySelector("[filter]"),m=n.querySelector("[selected]"),p=n.querySelector("[menu]"),S=p.querySelector("[option]"),L=document.createElement("div");n.classList.add("relative","!flex-col","w-full"),p.classList.add("hidden","z-10","absolute","top-0","w-full"),L.className="flex flex-wrap !justify-start gap-1",n.appendChild(L);const E=S.cloneNode(!0),k=E.querySelector('[type="checkbox"]'),b=E.querySelector("[option-label]");b.innerText=i?"-- Tambahkan Semua --":"-- Hapus Pilihan --",b.classList.add("text-stone"),k.addEventListener("change",C),c.addEventListener("focus",q),c.addEventListener("blur",A),c.addEventListener("keydown",M),c.addEventListener("input",T),document.addEventListener("mousedown",H),document.addEventListener("mouseup",F),R();function C(){i?k.checked?(l=d,b.innerText="[Clear Selection]"):(l=[],b.innerText="[Add All]"):l=[],w(),m.dispatchEvent(new Event("input"))}function T(){const e=String(c.value).toLowerCase();y.forEach((t,s)=>{var u;((u=String(d[s][f]))==null?void 0:u.toLowerCase()).includes(e)?t.style.display="block":t.style.display="none"}),i||(L.textContent="")}function q(){p.style.display="block",g=!0}function A(){x||(p.style.display="none",g=!1),x=!1}function M(e){e.key==="ArrowDown"||e.key==="ArrowUp"?(e.preventDefault(),N(e.key==="ArrowDown"?"next":"prev")):e.key==="Enter"&&(e.preventDefault(),I())}function H(e){const t=e.target;x=!0,g&&!p.contains(t)&&(p.style.display="none",g=!1)}function F(e){const t=e.target;g&&p.contains(t)&&(i||(p.style.display="none",g=!1))}function N(e){const t=[E,...y.filter(s=>s.style.display!=="none")];t.length!==0&&(e==="next"?h=(h+1)%t.length:h=(h-1+t.length)%t.length,h>=0&&t.forEach((s,r)=>{var u,v,B,D;if(r===h){(v=(u=s.children[0])==null?void 0:u.classList)==null||v.add("bg-neutral:10");const j=s.parentElement,U=s.getBoundingClientRect(),V=j.getBoundingClientRect(),$=U.top-V.top;j.scrollTop+=$-8}else(D=(B=s.children[0])==null?void 0:B.classList)==null||D.remove("bg-neutral:10")}))}function I(){if(h>=0&&h<y.length+1){const e=[E,...y][h].querySelector('[type="checkbox"]');e.checked=!e.checked,e.dispatchEvent(new Event("change")),c.blur()}}function w(e=!1){var t,s;e&&c.focus(),y.forEach(r=>{const u=r.querySelector('[type="checkbox"]');u.checked=l.some(v=>v[o].toString()===u.value)}),i?(m.value=l.map(r=>r[o]).join(","),L.innerHTML=l.map(r=>`<span badge="~ primary" hover-badge-secondary>${r[f]}</span>`).join(" "),n.dispatchEvent(new CustomEvent("selected",{detail:l}))):(m.value=((t=l.at(0))==null?void 0:t[o])||"",c.value=((s=l.at(0))==null?void 0:s[f])||"",c.style.height=c.scrollHeight+2+"px",k.checked=!1,n.dispatchEvent(new CustomEvent("selected",{detail:l.at(0)})))}function R(){if(a&&(typeof a.at(0)=="string"?d=a.map(e=>({id:e,name:e})):d=a,p.textContent="",p.appendChild(E),y=[],d.forEach(e=>{const t=S.cloneNode(!0),s=t.querySelector('[type="checkbox"]'),r=t.querySelector("[option-label]");s.value=String(e[o]),r.textContent?r.innerHTML=r.innerHTML.replace(/\((.*?)\)/g,(u,v)=>String(z(e,v))||u)||"":r.textContent=e[f],s.addEventListener("change",()=>{i?s.checked?l.push(e):l=l.filter(u=>u[o]!==e[o]):(l=s.checked?[e]:[],y.forEach(u=>{const v=u.querySelector('[type="checkbox"]');v.checked=v.value===e[o].toString()})),w(),m.dispatchEvent(new Event("input"))}),y.push(t),p.appendChild(t)}),c.value!=""&&(l=d.filter(e=>String(e[f]).toLowerCase()==String(c.value).toLowerCase()),w()),m.value!="")){const e=m.value.split(",");l=d.filter(t=>e.reduce((s,r)=>String(t[o]).toLowerCase()==String(r).toLowerCase()||s,!1)),l.length>0&&setTimeout(()=>{n.dispatchEvent(new CustomEvent("selected",{detail:l.at(0)}))},1),w()}}function K(e){a!==e&&(a=e,R(),w())}function P(){k.removeEventListener("change",C),c.removeEventListener("focus",q),c.removeEventListener("blur",A),c.removeEventListener("keydown",M),c.removeEventListener("input",T),document.removeEventListener("mousedown",H)}return{update:K,destroy:P}}export{J as a,G as f};
