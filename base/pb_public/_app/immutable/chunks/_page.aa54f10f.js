import{s as G,n as K,r as J,c as Q,o as W,f as X}from"./scheduler.51cf8014.js";import{S as Y,i as Z,e as _,s as V,c as b,a as w,m as L,f as H,d as g,g as a,h as C,j as d,n as O,q as ee,x as R,p as te,H as A,v as B}from"./index.69f60693.js";import{e as U}from"./each.e59479a4.js";import{s as re,d as N,u as ae}from"./db.3f800f8a.js";function $(p,e,r){const c=p.slice();return c[4]=e[r],c}function le(p){let e,r,c='<img src="/avatar.png" alt="avatar"/>',n,t,l,u,v=p[4].content+"",f;return{c(){e=_("div"),r=_("div"),r.innerHTML=c,n=V(),t=_("div"),l=_("div"),u=new A(!1),f=V(),this.h()},l(i){e=b(i,"DIV",{grid:!0,"gap-2":!0,"place-items-start":!0});var s=w(e);r=b(s,"DIV",{avatar:!0,"w-10":!0,"rounded-full":!0,"data-svelte-h":!0}),L(r)!=="svelte-tkaf7s"&&(r.innerHTML=c),n=H(s),t=b(s,"DIV",{});var I=w(t);l=b(I,"DIV",{"chat-bubble":!0,"bg-base-b":!0,"break-all":!0});var y=w(l);u=B(y,!1),y.forEach(g),I.forEach(g),f=H(s),s.forEach(g),this.h()},h(){a(r,"avatar",""),a(r,"w-10",""),a(r,"rounded-full",""),u.a=null,a(l,"chat-bubble",""),a(l,"bg-base-b",""),a(l,"break-all",""),a(e,"grid","~ cols-[auto_1fr]"),a(e,"gap-2",""),a(e,"place-items-start","")},m(i,s){C(i,e,s),d(e,r),d(e,n),d(e,t),d(t,l),u.m(v,l),d(e,f)},p(i,s){s&1&&v!==(v=i[4].content+"")&&u.p(v)},d(i){i&&g(e)}}}function ne(p){let e,r,c='<img src="/avatar.png" alt="avatar"/>',n,t,l,u,v=p[4].content+"",f;return{c(){e=_("div"),r=_("div"),r.innerHTML=c,n=V(),t=_("div"),l=_("div"),u=new A(!1),f=V(),this.h()},l(i){e=b(i,"DIV",{grid:!0,"gap-2":!0,"place-items-end":!0});var s=w(e);r=b(s,"DIV",{avatar:!0,"w-10":!0,"rounded-full":!0,"order-2":!0,"data-svelte-h":!0}),L(r)!=="svelte-qwtt15"&&(r.innerHTML=c),n=H(s),t=b(s,"DIV",{});var I=w(t);l=b(I,"DIV",{"chat-bubble":!0,"bg-base-b":!0,"break-all":!0});var y=w(l);u=B(y,!1),y.forEach(g),I.forEach(g),f=H(s),s.forEach(g),this.h()},h(){a(r,"avatar",""),a(r,"w-10",""),a(r,"rounded-full",""),a(r,"order-2",""),u.a=null,a(l,"chat-bubble",""),a(l,"bg-base-b",""),a(l,"break-all",""),a(e,"grid","~ cols-[1fr_auto]"),a(e,"gap-2",""),a(e,"place-items-end","")},m(i,s){C(i,e,s),d(e,r),d(e,n),d(e,t),d(t,l),u.m(v,l),d(e,f)},p(i,s){s&1&&v!==(v=i[4].content+"")&&u.p(v)},d(i){i&&g(e)}}}function z(p){let e;function r(t,l){var u;return((u=t[1])==null?void 0:u.id)==t[4].owner?ne:le}let c=r(p),n=c(p);return{c(){n.c(),e=R()},l(t){n.l(t),e=R()},m(t,l){n.m(t,l),C(t,e,l)},p(t,l){c===(c=r(t))&&n?n.p(t,l):(n.d(1),n=c(t),n&&(n.c(),n.m(e.parentNode,e)))},d(t){t&&g(e),n.d(t)}}}function se(p){var j,F;let e,r,c='<h1 text-xl="">Messages</h1>',n,t,l,u,v,f,i,s,I,y,P='<input name="content" input="" autofocus="" placeholder="Type message" autocomplete="off"/> <button btn=""><i i-bx-send=""></i></button>',q,S,T=U(((F=(j=p[0])==null?void 0:j.items)==null?void 0:F.reverse())||[]),h=[];for(let o=0;o<T.length;o+=1)h[o]=z($(p,T,o));return{c(){e=_("div"),r=_("div"),r.innerHTML=c,n=V(),t=_("div"),l=_("div");for(let o=0;o<h.length;o+=1)h[o].c();u=V(),v=_("div"),f=_("form"),i=_("input"),I=V(),y=_("div"),y.innerHTML=P,this.h()},l(o){e=b(o,"DIV",{"min-h-screen":!0,"px-2":!0});var k=w(e);r=b(k,"DIV",{"py-5":!0,"data-svelte-h":!0}),L(r)!=="svelte-eeubis"&&(r.innerHTML=c),n=H(k),t=b(k,"DIV",{"min-h-80vh":!0,"pb-20":!0});var D=w(t);l=b(D,"DIV",{grid:!0,"gap-3":!0});var M=w(l);for(let E=0;E<h.length;E+=1)h[E].l(M);M.forEach(g),D.forEach(g),u=H(k),v=b(k,"DIV",{sticky:!0,"bottom-5":!0,"left-0":!0,"right-0":!0});var x=w(v);f=b(x,"FORM",{action:!0});var m=w(f);i=b(m,"INPUT",{name:!0,type:!0}),I=H(m),y=b(m,"DIV",{"group-x-rounded":!0,"data-svelte-h":!0}),L(y)!=="svelte-mobeuh"&&(y.innerHTML=P),m.forEach(g),x.forEach(g),k.forEach(g),this.h()},h(){var o;a(r,"py-5",""),a(l,"grid",""),a(l,"gap-3",""),a(t,"min-h-80vh",""),a(t,"pb-20",""),a(i,"name","owner"),a(i,"type","hidden"),i.value=s=(o=p[1])==null?void 0:o.id,a(y,"group-x-rounded",""),a(f,"action","?/messages"),a(v,"sticky",""),a(v,"bottom-5",""),a(v,"left-0",""),a(v,"right-0",""),a(e,"min-h-screen",""),a(e,"px-2","")},m(o,k){C(o,e,k),d(e,r),d(e,n),d(e,t),d(t,l);for(let D=0;D<h.length;D+=1)h[D]&&h[D].m(l,null);d(e,u),d(e,v),d(v,f),d(f,i),d(f,I),d(f,y),q||(S=[O(f,"submit",te(re)),O(f,"reset",p[2])],q=!0)},p(o,[k]){var D,M,x;if(k&3){T=U(((M=(D=o[0])==null?void 0:D.items)==null?void 0:M.reverse())||[]);let m;for(m=0;m<T.length;m+=1){const E=$(o,T,m);h[m]?h[m].p(E,k):(h[m]=z(E),h[m].c(),h[m].m(l,null))}for(;m<h.length;m+=1)h[m].d(1);h.length=T.length}k&2&&s!==(s=(x=o[1])==null?void 0:x.id)&&(i.value=s)},i:K,o:K,d(o){o&&g(e),ee(h,o),q=!1,J(S)}}}function ie(p,e,r){let c;Q(p,ae,u=>r(1,c=u));let n;W(async()=>{await t(),N.collection("messages").subscribe("*",()=>{t()})}),X(()=>{N.collection("messages").unsubscribe("*")});async function t(){r(0,n=await N.collection("messages").getList(1,30,{expand:"owner,to",sort:"-created",requestKey:"refresh"}))}return[n,c,()=>{window.scrollTo(0,document.body.scrollHeight)}]}class ve extends Y{constructor(e){super(),Z(this,e,ie,se,G,{})}}export{ve as default};
